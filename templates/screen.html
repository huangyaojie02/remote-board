<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>远程留言 - 显示端</title>
  <link rel="stylesheet" href="/static/style.css" />
  <style>
    body { margin:0; background:#111; color:#fff; display:flex; align-items:center; justify-content:center; height:100vh; }
    #board { font-size:8vw; text-align:center; word-break:break-word; }
    #status { position:fixed; bottom:10px; left:10px; font-size:14px; color:#888; }
  </style>
</head>
<body class="screen">
  <div id="board">你好外公 🌞</div>
  <div id="status">状态：等待连接…</div>

  <!-- ⚠️ 同样使用后端自带 socket.io 脚本 -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const boardEl  = document.getElementById("board");
    const statusEl = document.getElementById("status");

    function show(s){ statusEl.textContent = "状态：" + s; }

    // 连接 /screen 命名空间
    const socket = io("/screen", { transports: ["websocket"] });

    socket.on("connect",       () => show("已连接 /screen (id=" + socket.id + ")"));
    socket.on("connect_error", e  => show("连接失败：" + e.message));
    socket.on("disconnect",    r  => show("断开：" + r));

    // 接收后端广播的 update 消息
    socket.on("update", data => {
      const text = (data && data.text) ? data.text : "";
      boardEl.textContent = text || "（暂无内容）";
      show("已更新");
    });
  </script>
</body>
</html>
